---
- name: install required packages for ansible modules
  raw: dnf install --quiet --assumeyes python2 python2-dnf libselinux-python
  changed_when: false

- name: install vagrant and dependencies
  dnf: name={{ item }} state=present
  with_items:
  - vagrant
  - ruby-devel
  - libffi-devel
  - redhat-rpm-config

- name: install vagrant plugins
  dnf: name=vagrant-{{ item.key }} state=present
  with_dict: "{{ vagrant_plugins }}"
  when: item.value

- include: install_libvirt-Fedora.yml
  when: vagrant_plugins.libvirt

#  - name: 
#    unless: vagrant box list

#- name: open up firewalld for nfs service
#  firewalld: service={{ item }} permanent=true state=enabled immediate=true
#  with_items:
#    - nfs
#    - rpc-bind
#    - mountd

#- name: open up firewalld ports for nfs
#  firewalld: port={{ item }} permanent=true state=enabled immediate=true
#  with_items:
#    - 2049/udp
    
#- name: install system group
#  group: name=vagrant state=present

#- name: write sudoers.d
#  template: src=sudoers.j2 dest=/etc/sudoers.d/vagrant mode=0755 validate='visudo -cf %s'

#- name: install vagrant package
#  yum:
#    name=vagrant
#    state=present
#  changed_when: false
#  when: ansible_distribution_major_version|int < 22

#- name: install vagrant package
#  dnf:
#    name=vagrant
#    state=present
#  changed_when: false
#  when: ansible_distribution_major_version|int >= 22


#vagrant_provider:
#  libvirt: true
#  lxc: false

